-- Leaderstats.lua (Colocar en ServerScriptService)
local Players = game:GetService("Players")

local LeaderstatsManager = {}

-- Función para crear leaderstats para un jugador
function LeaderstatsManager:InicializarLeaderstats(player)
	-- Si ya tiene leaderstats, no hacemos nada
	if player:FindFirstChild("leaderstats") then
		return
	end

	-- Creamos la carpeta leaderstats
	local leaderstats = Instance.new("Folder")
	leaderstats.Name = "leaderstats"
	leaderstats.Parent = player

	-- Oro total (persistente)
	local gold = Instance.new("IntValue")
	gold.Name = "Gold"
	gold.Value = 0
	gold.Parent = leaderstats

	-- Estadísticas de partida (temporales)
	local kills = Instance.new("IntValue")
	kills.Name = "Kills"
	kills.Value = 0
	kills.Parent = leaderstats

	local muertes = Instance.new("IntValue")
	muertes.Name = "Muertes"
	muertes.Value = 0
	muertes.Parent = leaderstats

	local asistencias = Instance.new("IntValue")
	asistencias.Name = "Asistencias"
	asistencias.Value = 0
	asistencias.Parent = leaderstats

	local oroPartida = Instance.new("IntValue")
	oroPartida.Name = "OroPartida"
	oroPartida.Value = 0
	oroPartida.Parent = leaderstats

	print("✅ Leaderstats creado para: " .. player.Name)
end

-- Función para actualizar leaderstats desde otros scripts del servidor
function LeaderstatsManager:ActualizarLeaderstats(player, stats)
	if player and player.Parent and player:FindFirstChild("leaderstats") then
		local ls = player.leaderstats
		if ls:FindFirstChild("Kills") then ls.Kills.Value = stats.Kills end
		if ls:FindFirstChild("Muertes") then ls.Muertes.Value = stats.Muertes end
		if ls:FindFirstChild("Asistencias") then ls.Asistencias.Value = stats.Asistencias end
		if ls:FindFirstChild("OroPartida") then ls.OroPartida.Value = stats.OroGanado end
	end
end

-- Inicializar jugadores existentes y conectar evento para nuevos
for _, player in ipairs(Players:GetPlayers()) do
	LeaderstatsManager:InicializarLeaderstats(player)
end

Players.PlayerAdded:Connect(function(player)
	LeaderstatsManager:InicializarLeaderstats(player)
end)

return LeaderstatsManager